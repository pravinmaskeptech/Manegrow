@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<style>
    #example .form-control {
        width: 60px;
        padding: 0;
    }

    #real.UOM form-control {
        width: 60px;
        padding: 0;
    }

    .rdonly {
        pointer-events: none;
    }
</style>
<input type="hidden" id="ID" name="ID" />

<br />
<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">

                        @using (Html.BeginForm(null, null, FormMethod.Post, new
                        {
                            @id = "form0",
                            onSubmit = "return false"
                        }))
                        {
                            @Html.AntiForgeryToken()

                            <div class="form-horizontal">
                                <div class="content-header" style="padding:1px">
                                    <h4>Vendor Quotation</h4>
                                </div>
                                <hr />
                                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                            <div class="modal-body">
                                <input type="hidden" id="ID" name="ID" value="0">
                                <input type="hidden" id="Count" name="Count" value="111">
                                <input type="hidden" id="HFVENDORE" name="HFVENDORE" />

                                <div id="DisabledControls">

                                    <div class="row" id="rd">


                                        <div class="col-md-2 col-12">Route Name</div>
                                        <div class="col-md-2 col-12">
                                            @Html.DropDownList("Route", new SelectList(ViewBag.Root, "ID", "MainRouteName"), "Select Route", new { @class = "form-control", Autocomplete = "off", @onchange = "GetSubRoute()" })
                                        </div>
                                        <div class="col-md-2 col-12">
                                            <lable>GSTApplicable</lable>
                                        </div>
                                        <div class="col-md-2 col-12">
                                            <input class="form-check-input" type="checkbox" id="GSTApplicable">
                                        </div>

                                        <div class="col-md-2 col-12">
                                            <lable>FSCharges</lable>
                                        </div>
                                        <div class="col-md-2 col-12">
                                            <input type="text" class="form-control" placeholder="In Percentage" id="FSCharges">
                                        </div>
                                        <div style="display:none">
                                            <div class="col-md-2 col-12">
                                                <lable>Enter Date</lable>
                                            </div>
                                            <div class="col-md-2 col-12">
                                                <input type="text" class="form-control" id="mydate">
                                            </div>
                                        </div>
                                    </div>
                                 
                                </div>
                                <hr />
                                <div class="row">

                                    <div class="col-md-12">
                                        <br />

                                        <div class="table-responsive">
                                            <div style="overflow: scroll">
                                                <table id="example" class="table table-striped table-bordered dt-responsive" style="white-space:nowrap">
                                                    <thead style="background-color: #d8e9c1;font-size:12px">
                                                        <tr class="text-uppercase">
                                                            <td><strong>Vendor Name</strong></td>
                                                            <td><strong>Sub Route</strong></td>
                                                            <td><strong>From City</strong></td>
                                                            <th>To City</th>
                                                            <th>UOM</th>

                                                            <th>WT From 1</th>
                                                            <th>WT To 1</th>
                                                            <th>Rate 1</th>
                                                            <th>WT From 2</th>
                                                            <th>WT To 2</th>
                                                            <th>Rate 2</th>
                                                            <th>WT From 3</th>
                                                            <th>WT To 3</th>
                                                            <th>Rate 3</th>
                                                            <th>Add Wt</th>
                                                            <th>Add Rate</th>
                                                            <th></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>
                                                                @Html.DropDownList("VendorName", new SelectList(ViewBag.VendorName, "ID", "VendorName"), "Select", new
                                  {
                                      @class = "form-control",
                                      style = "width:150px",
                                      onchange = "GetVendorFromCities()"
                                  })
                                                            </td>
                                                            <td>

                                                                @Html.DropDownList("SubRoute", new SelectList(ViewBag.CityName, "CityName", "CityName"), "Select", new
                                                      {
                                                          @class = "form-control",@*onchange = "getproducts()",*@style = "width:150px"
})
                                                            </td>
                                                            <td>
                                                                @Html.DropDownList("FromCity", new SelectList(ViewBag.CityName, "CityName", "CityName"), "Select", new
                                                           {
                                                               @class = "form-control",@*onchange = "getproducts()",*@style = "width:150px"

})
                                                            </td>
                                                            <td>
                                                                @Html.DropDownList("ToCity", new SelectList(ViewBag.CityName, "CityName", "CityName"), "Select", new
                                                           {
                                                               @class = "form-control",@*onchange = "getproducts()",*@style = "width:150px"
})
                                                            </td>
                                                            <td>
                                                                <select id="UOM" name="UOM" class="form-control" style="width:150px" onchange="DisabledWeight()">
                                                                    <option value="">Select UOM</option>
                                                                    <option value="WEIGHT">WEIGHT</option>
                                                                    <option value="BOX">BOX</option>
                                                                    <option value="TRIP">TRIP</option>
                                                                    <option value="PER KM">PER KM</option>
                                                                    <option value="UP TO KM">UP TO KM</option>
                                                                </select>
                                                            </td>


                                                            <td><input type="text" id="WTFrom1" name="WTFrom1" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>
                                                            <td><input type="text" id="WTTo1" name="WTTo1" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>
                                                            <td><input type="text" id="Rate1" name="Rate1" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>

                                                            <td><input type="text" id="WTFrom2" name="WTFrom2" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>
                                                            <td><input type="text" id="WTTo2" name="WTTo2" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>
                                                            <td><input type="text" id="Rate2" name="Rate2" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>

                                                            <td><input type="text" id="WTFrom3" name="WTFrom3" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>
                                                            <td><input type="text" id="WTTo3" name="WTTo3" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>
                                                            <td><input type="text" id="Rate3" name="Rate3" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>

                                                            <td><input type="text" id="AddWt" name="AddWt" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>
                                                            <td><input type="text" id="AddRate" name="AddRate" class="form-control" onkeypress="return event.charCode >= 46 && event.charCode <= 57 && event.charCode!=47" /></td>


                                                            <td><button type="button" class="btn btn-primary" onclick="btnadd()">Add+</button> <input type="hidden" id="DetailsID" value="0" /></td>
                                                        </tr>
                                                    </tbody>

                                                </table>
                                            </div>
                                        </div>
                                        @*<button type="button" class="btn btn-success" onclick="Save()"> Save </button>*@
                                    </div>


                                    <div class="col-md-12">
                                        <br />
                                        <div class="table-responsive">
                                            <div style="overflow: scroll">
                                                <table id="real" class="table table-striped table-bordered dt-responsive" style="white-space:nowrap;font-size:12px">
                                                    <thead style="background-color: #d8e9c1">
                                                        <tr class="text-uppercase">
                                                            <td><strong> Vendor Name </strong></td>
                                                            <td><strong> Sub Route </strong></td>
                                                            <td><strong> From City </strong></td>
                                                            <th>To City</th>
                                                            <th>UOM</th>
                                                            <th>WT From 1</th>
                                                            <th>WT To 1</th>
                                                            <th>Rate 1</th>
                                                            <th>WT From 2</th>
                                                            <th>WT To 2</th>
                                                            <th>Rate 2</th>
                                                            <th>WT From 3</th>
                                                            <th>WT To 3</th>
                                                            <th>Rate 3</th>
                                                            <th>Add Wt</th>
                                                            <th>Add Rate</th>

                                                            <th></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    </tbody>

                                                </table>
                                            </div>
                                        </div>
                                        <button type="button" class="btn btn-success" onclick="Save()"> Save </button>
                                        <a href="@Url.Action("Index", "VendorQuotationMain")" class="btn btn-primary"> Back to List </a>
                                        @*<button type="button" class="btn btn-outline-danger" onclick="Clear()"> Clear </button>*@
                                    </div>

                                </div>


                                <br />

                            </div>

                            </div>
                         }

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.10.0.min.js" type="text/javascript"></script>
<script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.2/jquery-ui.min.js" type="text/javascript"></script>
<link href="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.9.2/themes/blitzer/jquery-ui.css" rel="Stylesheet" type="text/css" />

<script src="~/Scripts/jquery.preloaders.js"></script>


<script>

    $(document).ready(function () {

        try {
            //$('#mydate').datepicker({
            //    dateFormat: 'dd-mm-yy',
            //    autoclose: true
            //});
            var today = new Date();
            var dd = String(today.getDate()).padStart(2, '0');
            var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
            var yyyy = today.getFullYear();

            today = dd + '-' + mm + '-' + yyyy;
            $('#mydate').val(today);
            var url = window.location.href;
            var part = url.substring(url.lastIndexOf('/') + 1);
            if (part != "Create") {
                $('#ID').val(part);
                $('#DisabledControls').find('input, textarea, button, select').attr('disabled', 'disabled');

                
          $.ajax({
            type: "GET",
            url: '@Url.Action("GetEditData", "VendorQuotationMain")',
              data: { ID: part },
            dataType: "json",
            success: function (result)
            {
                if (result.Message == "success") {

                    
                    $('#Route').val(result.data[0].MainRouteID);
                 

                    $('#HFVENDORE').val(result.data[0].VendorID)
                    GetSubRoute();
                  
                    $('#FSCharges').val(result.data[0].FSCharges);


                    if (result.data[0].GSTApplicable == true) {
                        $('#GSTApplicable').prop("checked",true);
                    }

                    var value = new Date(parseInt(result.data[0].CreatedDate.substr(6)));
                    var month = ("0" + (value.getMonth() + 1)).slice(-2);
                    var day = ("0" + value.getDate()).slice(-2);
                    var ret = day + "-" + month + "-" + value.getFullYear();
                    $("#mydate").val(ret);

                    $.each(result.data, function (i, Temp) {
                        var Count = $('#Count').val();
                        $("#real").append(" <tbody> <tr id='R" + Count + "'>"
                            + " <td><input type='text' id='VendorName" + Count + "' readonly  style='width:150px'  class='VendorName form-control'' /></td>"
                            + " <td><input type='text' id='SubRoute" + Count + "' readonly  style='width:150px'  class='SubRoute form-control'' /></td>"
                            + " <td><input type='text' id='FromCity" + Count + "' readonly  style='width:150px'  class='FromCity form-control'' /></td>"
                            + "<td><input type='text' id='ToCity" + Count + "' readonly  style='width:150px' class='ToCity form-control'' /></td>"
                            + "<td><input type='text' id='UOM" + Count + "'   style='width:150px'   readonly class='UOM form-control'' /></td>"
                            + "<td><input type='text' id='WTFrom1" + Count + "'  style='width:60px'   readonly class='WTFrom1 form-control'' /></td>"
                            + "<td><input type='text' id='WTTo1" + Count + "'  style='width:60px'  readonly class='WTTo1 form-control'' /></td>"
                            + "<td><input type='text'  id='Rate1" + Count + "'  style='width:60px'  readonly class='Rate1 form-control'' /></td>"

                            + "<td><input type='text' id='WTFrom2" + Count + "'  style='width:60px'   readonly class='WTFrom2 form-control'' /></td>"
                            + "<td><input type='text' id='WTTo2" + Count + "'  style='width:60px'  readonly class='WTTo2 form-control'' /></td>"
                            + "<td><input type='text'  id='Rate2" + Count + "'  style='width:60px'  readonly class='Rate2 form-control'' /></td>"

                            + "<td><input type='text' id='WTFrom3" + Count + "'  style='width:60px'   readonly class='WTFrom3 form-control'' /></td>"
                            + "<td><input type='text' id='WTTo3" + Count + "'  style='width:60px'   readonly class='WTTo3 form-control'' /></td>"
                            + "<td><input type='text'  id='Rate3" + Count + "'  style='width:60px'  readonly class='Rate3 form-control'' /></td>"

                            + "<td><input type='text' id='AddWt" + Count + "'  style='width:60px'   readonly class='AddWt form-control'' /></td>"
                            + "<td><input type='text'  id='AddRate" + Count + "'  style='width:60px'  readonly class='AddRate form-control'' /></td>"


                            + "<td><Button type='Button' class='btn btn-sm btn-primary btnDelete' href='#'  onclick='Edit(" + Count + ")'  id='dlt' > <i class='fa fa-edit'></i> </Button> "



                            + "<td><Button type='Button' class='btn btn-sm btn-danger btnDelete' href='#'  onclick='Remove(" + Count + ")'  id='dlt' > <i class='fa fa-trash-alt'></i> </Button> "
                            + "<input type='hidden'  id='FromCity" + Count + "'    class='FromCity form-control'' />"
                            + "<input type='hidden'  id='DetailsID" + Count + "'    class='DetailsID form-control'' />"
                            + "<input type='hidden'  id='SubRouteID" + Count + "'    class='SubRouteID form-control'' />"
                            + "<input type='hidden'  id='VendorID" + Count + "'    class='VendorID form-control'' />"
                            + "<input type='hidden'  id='ToCity" + Count + "'    class='ToCity form-control'' /></td></tr> <tbody>");

                        debugger;

                        

                        $('#VendorName' + Count).val(Temp.VendorName);
                        $('#VendorID' + Count).val(Temp.VendorID);
                        $('#FromCity' + Count).val(Temp.FromCity);
                        $('#ToCity' + Count).val(Temp.ToCity);

                        $('#DetailsID' + Count).val(Temp.DetailsID);
                        $('#SubRoute' + Count).val(Temp.SubRoute);
                        $('#SubRouteID' + Count).val(Temp.SubRouteID);
                        

                        $('#UOM' + Count).val(Temp.UOM);
                        $('#WTFrom1' + Count).val(Temp.WTFrom1);
                        $('#WTTo1' + Count).val(Temp.WTTo1);
                        $('#Rate1' + Count).val(Temp.Rate1);
                        $('#WTFrom2' + Count).val(Temp.WTFrom2);
                        $('#WTTo2' + Count).val(Temp.WTTo2);
                        $('#Rate2' + Count).val(Temp.Rate2);
                        $('#WTFrom3' + Count).val(Temp.WTFrom3);
                        $('#WTTo3' + Count).val(Temp.WTTo3);
                        $('#Rate3' + Count).val(Temp.Rate3);

                        $('#AddWt' + Count).val(Temp.AddWt);
                        $('#AddRate' + Count).val(Temp.AddRate);

                        $("#Count").val(Count + 1);

                    });


                    GetVendorFromCities()

                }
            },
            failure: function (response) {
                $("#example tbody").empty();
            },
            error: function (err) {
                $("#example tbody").empty();
            }
        });
            }
        }
        catch (e) {
        }
    });







    function btnadd() {

        var valid = true;

        if ($('#FromCity').val() == null || $('#FromCity').val() == "") {
            toastr.error("FromCity is Required.");
            valid = false;
        }
        if ($('#ToCity').val() == null || $('#ToCity').val() == "") {
            toastr.error("ToCity  is Required.");
            valid = false;
        }
        if ($('#SubRoute').val() == null || $('#SubRoute').val() == "") {
            toastr.error("SubRoute is Required.");
            valid = false;
        }


        //if ($('#GSTApplicable').val() == null || $('#GSTApplicable').val() == "") {
        //    toastr.error("GSTApplicable is Required.");
        //    valid = false;
        //}

        if ($('#FSCharges').val() == null || $('#FSCharges').val() == "") {
            toastr.error("FSCharges  is FSCharges.");
            valid = false;
        }

        if ($('#VendorName').val() == null || $('#VendorName').val() == "") {
            toastr.error("Vendor Name is Required.");
            valid = false;
        }

        //if ($('#mydate').val() == null || $('#mydate').val() == "") {
        //    toastr.error("Date is Required.");
        //    valid = false;
        //}



        if ($('#WTFrom1').val() == null || $('#WTFrom1').val() == "") {
            toastr.error("WTFrom1 is Required.");
            valid = false;
        }


        if ($('#WTTo1').val() == null || $('#WTTo1').val() == "") {
            toastr.error("WTTo1 is Required.");
            valid = false;
        }
        if ($('#Rate1').val() == null || $('#Rate1').val() == "") {
            toastr.error("Rate1 is Required.");
            valid = false;
        }




        if ($('#WTFrom2').val() == null || $('#WTFrom2').val() == "") {
            toastr.error("WTFrom2 is Required.");
            valid = false;
        }


        if ($('#WTTo2').val() == null || $('#WTTo2').val() == "") {
            toastr.error("WTTo2 is Required.");
            valid = false;
        }
        if ($('#Rate2').val() == null || $('#Rate2').val() == "") {
            toastr.error("Rate2 is Required.");
            valid = false;
        }



        if ($('#WTFrom3').val() == null || $('#WTFrom3').val() == "") {
            toastr.error("WTFrom3 is Required.");
            valid = false;
        }


        if ($('#WTTo3').val() == null || $('#WTTo3').val() == "") {
            toastr.error("WTTo3 is Required.");
            valid = false;
        }
        if ($('#Rate3').val() == null || $('#Rate3').val() == "") {
            toastr.error("Rate3 is Required.");
            valid = false;
        }


        $('#real tbody tr').each(function (index, e) {
            var FromCity = $(e).children().get(0);
            var ToCity = $(e).children().get(1);
            if ($("#FromCity").val() == FromCity.firstElementChild.value && $("#ToCity").val() == ToCity.firstElementChild.value) {
                valid = false;
                toastr.error("Record Already Added...");
            }
        });


        if (valid == true) {
            var Count = $('#Count').val();
            $('#VendorName').prop('disabled', false);
            $('#VendorID').prop('disabled', false);
            $('#GSTApplicable').prop('disabled', false);
            $('#FSCharges').prop('disabled', false);
            $('#mydate').prop('disabled', false);
            $("#real").append(" <tbody> <tr id='R" + Count + "'>"
                + " <td><input type='text' id='VendorName" + Count + "' readonly  style='width:150px'  class='VendorName form-control'' /></td>"
                + " <td><input type='text' id='SubRoute" + Count + "' readonly  style='width:150px'  class='SubRoute form-control'' /></td>"
                + " <td><input type='text' id='FromCity" + Count + "' readonly  style='width:150px'  class='FromCity form-control'' /></td>"
                + "<td><input type='text' id='ToCity" + Count + "' readonly  style='width:150px' class='ToCity form-control'' /></td>"
                + "<td><input type='text' id='UOM" + Count + "'   style='width:150px'   readonly class='UOM form-control'' /></td>"
                + "<td><input type='text' id='WTFrom1" + Count + "'  style='width:60px'   readonly class='WTFrom1 form-control'' /></td>"
                + "<td><input type='text' id='WTTo1" + Count + "'  style='width:60px'  readonly class='WTTo1 form-control'' /></td>"
                + "<td><input type='text'  id='Rate1" + Count + "'  style='width:60px'  readonly class='Rate1 form-control'' /></td>"

                + "<td><input type='text' id='WTFrom2" + Count + "'  style='width:60px'   readonly class='WTFrom2 form-control'' /></td>"
                + "<td><input type='text' id='WTTo2" + Count + "'  style='width:60px'  readonly class='WTTo2 form-control'' /></td>"
                + "<td><input type='text'  id='Rate2" + Count + "'  style='width:60px'  readonly class='Rate2 form-control'' /></td>"

                + "<td><input type='text' id='WTFrom3" + Count + "'  style='width:60px'   readonly class='WTFrom3 form-control'' /></td>"
                + "<td><input type='text' id='WTTo3" + Count + "'  style='width:60px'   readonly class='WTTo3 form-control'' /></td>"
                + "<td><input type='text'  id='Rate3" + Count + "'  style='width:60px'  readonly class='Rate3 form-control'' /></td>"

                + "<td><input type='text' id='AddWt" + Count + "'  style='width:60px'   readonly class='AddWt form-control'' /></td>"
                + "<td><input type='text'  id='AddRate" + Count + "'  style='width:60px'  readonly class='AddRate form-control'' /></td>"

                + "<td><Button type='Button' class='btn btn-sm btn-danger btnDelete' href='#'  onclick='Remove(" + Count + ")'  id='dlt' > <i class='fa fa-trash-alt'></i> </Button> "
                + "<input type='hidden'  id='FromCity" + Count + "'    class='FromCity form-control'' />"
                + "<input type='hidden'  id='DetailsID" + Count + "'    class='DetailsID form-control'' />"
                + "<input type='hidden'  id='ToCity" + Count + "'    class='ToCity form-control'' />"
                + "<input type='hidden'  id='VendorID" + Count + "'    class='VendorID form-control'' />"
                + "<input type='hidden'  id='SubRouteID" + Count + "'    class='SubRouteID form-control'' /></td></tr> <tbody>");



            $('#FromCity' + Count).val($("#FromCity").val());
            $('#ToCity' + Count).val($("#ToCity").val());
            $('#SubRouteID' + Count).val($("#SubRoute").val());
            $('#SubRoute' + Count).val($("#SubRoute option:selected").text());


            $('#VendorID' + Count).val($("#VendorName").val());
            $('#VendorName' + Count).val($("#VendorName option:selected").text());

            

            $('#DetailsID' + Count).val($('#DetailsID').val());

            $('#DetailsID').val(0)

            $('#UOM' + Count).val($("#UOM").val());
            $('#WTFrom1' + Count).val($("#WTFrom1").val());
            $('#WTTo1' + Count).val($("#WTTo1").val());
            $('#Rate1' + Count).val($("#Rate1").val());
            $('#WTFrom2' + Count).val($("#WTFrom2").val());
            $('#WTTo2' + Count).val($("#WTTo2").val());
            $('#Rate2' + Count).val($("#Rate2").val());
            $('#WTFrom3' + Count).val($("#WTFrom3").val());
            $('#WTTo3' + Count).val($("#WTTo3").val());
            $('#Rate3' + Count).val($("#Rate3").val());

            $('#AddWt' + Count).val($("#AddWt").val());
            $('#AddRate' + Count).val($("#AddRate").val());
            $("#Count").val(Count + 1);


            $("#UOM").val('');
            $("#WTFrom1").val('');
            $("#WTTo1").val('');
            $("#Rate1").val('');
            $("#WTFrom2").val('');
            $("#WTTo2").val('');
            $("#Rate2").val('');
            $("#WTFrom3").val('');


            $("#WTTo3").val('');
            $("#Rate3").val('');
            $("#AddWt").val('');
            $("#AddRate").val('');
            $("#product").val('');
            $("#WTFrom1").focus();




        }
    }

    function Save() {
        var valid = true;
        if ($('#real TBODY tr').length == 0) {
            //...do something here
            toastr.error("Please add Some records.");
        }
        //if ($('#FromCity').val() == null || $('#FromCity').val() == "") {
        //    toastr.error("FromCity is Required.");
        //    valid = false;
        //}
        //if ($('#ToCity').val() == null || $('#ToCity').val() == "") {
        //    toastr.error("ToCity Category is Required.");
        //    valid = false;
        //}

        if ($('#FSCharges').val() == null || $('#FSCharges').val() == "") {
            toastr.error("FSCharges  is FSCharges.");
            valid = false;
        }

        //if ($('#VendorName').val() == null || $('#VendorName').val() == "") {
        //    toastr.error("Vendor Name is Required.");
        //    valid = false;
        //}


        if (valid==true) {

            $.preloader.start({
                modal: true,
                src: 'sprites2.png'
            });


            var recs = new Array();

            $("#real TBODY TR").each(function () {
                var row = $(this);
                var Order = {


                    FromCity: $('.FromCity', this).val(),
                    ToCity: $('.ToCity', this).val(),
                    UOM: $('.UOM', this).val(),

                    WTFrom3: $('.WTFrom3', this).val(),
                    WTTo3: $('.WTTo3', this).val(),
                    Rate3: $('.Rate3', this).val(),
                    WTFrom1: $('.WTFrom1', this).val(),
                    WTTo1: $('.WTTo1', this).val(),

                    Rate1: $('.Rate1', this).val(),
                    WTFrom2: $('.WTFrom2', this).val(),
                    WTTo2: $('.WTTo2', this).val(),
                    Rate2: $('.Rate2', this).val(),
                    AddWt: $('.AddWt', this).val(),
                    AddRate: $('.AddRate', this).val(),
                    DetailsID: $('.DetailsID', this).val(),
                    SubRouteID: $('.SubRouteID', this).val(),
                    SubRoute: $('.SubRoute', this).val(),
                    VendorID: $('.VendorID', this).val(),
                    VendorName: $('.VendorName', this).val(),

                    

                }
                recs.push(Order);
            });
            debugger;
            var data = {
                recs: recs, MainRouteName: $("#Route option:selected").text(), GSTApplicable: $('#GSTApplicable').is(':checked'), FSCharges: $('#FSCharges').val(), QuotationDate: $('#mydate').val(), ID: $('#ID').val(), MainRouteID: $('#Route').val()
            }

            //Send the JSON array to Controller using AJAX.
            $.ajax({
                type: "POST",
                url: "/VendorQuotationMain/Save",
                data: JSON.stringify(data),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
                    if (result.Message == "success") {
                        //$('#form0').each(function () {
                        //    this.reset();
                        //});
                        toastr.success("Records Saved Succesfully");
                        window.location.href = '@Url.Action("Index", "VendorQuotationMain")';


                        $.preloader.stop();
                    }
                    else {
                        toastr.error(result.Message);
                        $.preloader.stop();
                    }
                    $.preloader.stop();
                }
            });
        }
    }

    function DisabledWeight() {
        if ($('#UOM').val() == "TRIP" || $('#UOM').val() == "PER KM") {

            $("#WTFrom1").val("0").prop("disabled", true);
            $("#WTTo1").val("0").prop("disabled", true);
            $("#Rate1").val("0").prop("disabled", true);
            $("#WTFrom2").val("0").prop("disabled", true);
            $("#WTTo2").val("0").prop("disabled", true);
            $("#Rate2").val("0").prop("disabled", true);
            $("#WTFrom3").val("0").prop("disabled", true);
            $("#WTTo3").val("0").prop("disabled", true);
            $("#Rate3").val("0").prop("disabled", true);
            $("#AddWt").focus();


        }
        else {
            $("#WTFrom1").prop("disabled", false);
            $("#WTTo1").prop("disabled", false);
            $("#Rate1").prop("disabled", false);
            $("#WTFrom2").prop("disabled", false);
            $("#WTTo2").prop("disabled", false);
            $("#Rate2").prop("disabled", false);
            $("#WTFrom3").prop("disabled", false);
            $("#WTTo3").prop("disabled", false);
            $("#Rate3").prop("disabled", false);
        }


    }

    function Remove(Count) {
        $("#R" + Count + "").remove();
        CalculateGridData();
    }
    function CheckDuplicateVendorQuotationName() {

          $.ajax({
            type: "GET",
            url: '@Url.Action("CheckDuplicateVendorQuotationName", "VendorQuotationMain")',
              data: { ID: $('#ID').val(), VendorName: $('#VendorName').val() },
            dataType: "json",
            success: function (result)
            {
                if (result != 0) {
                    toastr.error("Vendor Name Already Added...");
                    $('#VendorName').val('');
                }

            },

        });
    }



    function Edit(Count) {
     //   $('#VendorName').val($('#VendorName' + Count).val());
    //    $('#VendorID').val($('#VendorID' + Count).val());
    //    $('#GSTApplicable').val($('#GSTApplicable' + Count).val());
      //  $('#FSCharges').val($('#FSCharges' + Count).val());

        $('#DetailsID').val($('#DetailsID' + Count).val());
        $('#FromCity').val($('#FromCity' + Count).val());
       $('#ToCity').val($('#ToCity' + Count).val());
        $('#UOM').val($('#UOM' + Count).val());

        $('#WTFrom3').val($('#WTFrom3' + Count).val());
        $('#WTTo3').val($('#WTTo3' + Count).val());
        $('#Rate3').val($('#Rate3' + Count).val());
        $('#WTFrom1').val($('#WTFrom1' + Count).val());
        $('#WTTo1').val($('#WTTo1' + Count).val());
        $('#Rate1').val($('#Rate1' + Count).val());
        $('#WTFrom2').val($('#WTFrom2' + Count).val());
        $('#WTTo2').val($('#WTTo2' + Count).val());
        $('#Rate2').val($('#Rate2' + Count).val());

        $('#AddWt').val($('#AddWt' + Count).val());
        $('#AddRate').val($('#AddRate' + Count).val());

        $('#VendorName').prop('disabled', true);
        $('#mydate').prop('disabled', true);



        Remove(Count);


    }
    function GetVendorFromCities() {
        $.preloader.start({
            modal: true,
            src: 'sprites2.png'
        });
    //    alert($('#VendorName').val())
         $.ajax({
            type: "GET",
            url: '@Url.Action("GetVendorFromCities", "VendorQuotationMain")',
             data: { VendorID: $('#VendorName').val() },
            dataType: "json",
             success: function (result)
            {
                $("#FromCity").empty();
                $("#FromCity").append("<option value=''>Select</option>");
                $("#ToCity").empty();
                $("#ToCity").append("<option value=''>Select</option>");

                $.each(result.CityList, function (i, val) {
                    $("#FromCity").append("<option value='" + val.FromRoute + "'>" + val.FromRoute + "</option>");
                    $("#ToCity").append("<option value='" + val.ToRoute + "'>" + val.ToRoute + "</option>");
                });


                 //$.each(result.SubRoute, function (i, val) {
                 //    $("#SubRoute").append("<option value='" + val.ID + "'>" + val.SubRouteName + "</option>");
                 //});


                $.preloader.stop();
            },
            failure: function (response) {
                $.preloader.stop();
                /*alert(response.d);*/
            },
            error: function (err) {
                $.preloader.stop();
                /*alert(err.statusText);*/
            }
        });
    }

        function GetSubRoute() {
         $.ajax({
                url: '@Url.Action("GetSubRoutes", "VendorQuotationMain")',
                type: "Get",
                dataType: "JSON",
             data: { RouteMainID: $('#Route').val() },
                success: function (result) {
                    try {
                        if (result.Message == "success") {
                            $("#SubRoute").empty();
                            $("#SubRoute").append("<option value=''>Select Sub Route</option>");
                            $.each(result.SubRoute, function (i, val) {
                                $("#SubRoute").append("<option value='" + val.ID + "'>" + val.SubRouteName + "</option>");
                            });

                            $("#VendorName").empty();
                            $("#VendorName").append("<option value=''>Select Vendor Name</option>");

                            $.each(result.RouteDetails, function (i, val) {
                                $("#VendorName").append("<option value='" + val.VendorID + "'>" + val.VendorName + "</option>");
                            });


                            //var url = window.location.href;
                            //var part = url.substring(url.lastIndexOf('/') + 1);
                            //if (part != "Create") {
                            //    $('#VendoreName').val($('#HFVENDORE').val());
                             
                            //}

                        } else {
                            toastr.error(result.Message);
                        }
                    }
                    catch (e) {
                    }
                }
            });

    }
</script>
